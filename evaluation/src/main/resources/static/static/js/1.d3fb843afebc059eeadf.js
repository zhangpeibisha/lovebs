webpackJsonp([1],{a8uz:function(t,e){},etH8:function(t,e){},mvHQ:function(t,e,n){t.exports={default:n("qkKv"),__esModule:!0}},pxpt:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("mvHQ"),s=n.n(i),o=n("woOf"),a=n.n(o),c={props:{question:{type:Object,required:!0},qIndex:{type:Number,required:!0}},methods:{changeQuestionTitle:function(t,e){this.$parent.changeQuestionTitle(t,e.target.textContent)},questionPositionFront:function(t){this.$parent.questionPositionChange(t,t-1)},questionPositionBack:function(t){this.$parent.questionPositionChange(t,t+1)},deleteQuestion:function(t){this.$parent.deleteQue(t)},changeOptionValue:function(t,e,n){this.$parent.changeOptionValue(t,e,n.target.textContent)},changeOptionValue1:function(t,e,n){this.$parent.changeOptionValue1(t,e,n.target.textContent)},addOption:function(t){this.$parent.addOption(t)},deleteOption:function(t,e){this.$parent.deleteOption(t,e)},copyQuestion:function(t){this.$parent.copyQuestion(t)},changeTextRequired:function(t,e){this.$parent.changeTextRequired("change-text-required",t,e.target.checked)},optionPositionFront:function(t,e){this.$parent.optionPositionChange(t,e,e-1)},optionPositionBack:function(t,e){this.$parent.optionPositionChange(t,e,e+1)}}},u={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",[n("div",{staticClass:"content"},[n("p",{staticClass:"input title",attrs:{contenteditable:""},on:{keyup:function(e){t.changeQuestionTitle(t.qIndex,e)}}},[t._v(t._s(t.question.title))]),t._v(" "),"text"!==t.question.questionnaireType?n("ol",{staticClass:"answers"},t._l(t.question.items,function(e,i){return n("li",{staticClass:"answer"},[n("input",{staticClass:"select",attrs:{type:t.question.questionnaireType,name:t.question.title},domProps:{value:"问题"+(t.qIndex+1)}}),t._v(" "),n("div",{staticClass:"option"},[n("div",{staticClass:"input-fix"},[n("p",{staticClass:"input",attrs:{contenteditable:""},on:{keyup:function(e){t.changeOptionValue(t.qIndex,i,e)},change:function(e){t.changeOptionValue(t.qIndex,i,e)}}},[t._v(t._s(e.title))]),t._v(" "),n("p",[t._v("分值:")]),t._v(" "),n("p",{staticClass:"input",attrs:{contenteditable:""},on:{keyup:function(e){t.changeOptionValue1(t.qIndex,i,e)},change:function(e){t.changeOptionValue1(t.qIndex,i,e)}}},[t._v(t._s(e.weights))])]),t._v(" "),n("ul",{staticClass:"option-panel"},[n("li",{staticClass:"iconfont",on:{click:function(e){t.optionPositionFront(t.qIndex,t.$index)}}},[t._v("↑")]),t._v(" "),n("li",{staticClass:"iconfont",on:{click:function(e){t.optionPositionBack(t.qIndex,t.$index)}}},[t._v("↓")]),t._v(" "),n("li",{directives:[{name:"show",rawName:"v-show",value:t.question.items.length>1,expression:"question.items.length > 1"}],staticClass:"iconfont",on:{click:function(e){t.deleteOption(t.qIndex,t.$index)}}},[t._v("")])])])])})):t._e(),t._v(" "),"text"!==t.question.questionnaireType?n("div",{staticClass:"add-option",on:{click:function(e){t.addOption(t.qIndex)}}},[n("span",{staticClass:"iconfont"},[t._v("")]),t._v("添加选项")]):n("div",{staticClass:"option"},[n("textarea",{staticClass:"textarea"}),t._v(" "),n("label",{attrs:{for:"isRequired"}},[n("input",{staticClass:"required",attrs:{id:"isRequired",type:"checkbox"},domProps:{checked:t.question.mustWriter},on:{change:function(e){t.changeTextRequired(t.qIndex,e)}}}),t._v("是否必填")])])]),t._v(" "),n("div",{staticClass:"side"},[n("div",{staticClass:"order"},[t._v("Q"+t._s(t.qIndex+1))]),t._v(" "),n("ul",{staticClass:"opertions"},[n("li",{staticClass:"iconfont",on:{click:function(e){t.questionPositionFront(t.qIndex)}}},[t._v("")]),t._v(" "),n("li",{staticClass:"iconfont",on:{click:function(e){t.questionPositionBack(t.qIndex)}}},[t._v("")]),t._v(" "),n("li",{staticClass:"iconfont",on:{click:function(e){t.copyQuestion(t.qIndex)}}},[t._v("")]),t._v(" "),n("li",{staticClass:"iconfont",on:{click:function(e){t.deleteQuestion(t.qIndex)}}},[t._v("")])])])])},staticRenderFns:[]};var l=n("VU/8")(c,u,!1,function(t){n("a8uz")},"data-v-adc1be52",null).exports,r=n("NoTa"),d=n("UDO9"),p=n("l2la"),h=n("Ozlq"),v={data:function(){var t=void 0;window.sessionStorage.getItem("edit-mode")?t=window.sessionStorage.getItem("edit-mode"):(t="create",window.sessionStorage.setItem("edit-mode","create"));var e={title:"问卷题目",questions:[],showAlert:!1,publish:!1,showModal:!1,routerCanDeactivate:!1,expires:"",qnId:-1,isLoading:!1,evaluationId:-1};return"create"===t&&a()(e,{qnId:this.createId()}),e},computed:{questionaire:function(){return{title:this.title,questions:this.questions,expires:this.expires,publish:this.publish,qnId:this.qnId}}},methods:{saveData:function(){var t=this;Object(h.a)({evaluationId:this.evaluationId},this.questions).then(function(e){t.$message({message:"恭喜你，成功创建了一个问卷",type:"success"}),t.$router.push({path:"/questionnaire/listView"})})},addQuestion:function(t){var e={title:"问题题目",questionnaireType:t};"text"!==t?e.items=[{title:"选项1",weights:10},{title:"选项2",weights:10}]:(e.mustWriter=!1,e.text=""),this.questions.push(e)},transposition:function(t,e,n){var i=t.splice(e,1)[0];t.splice(n,0,i)},modalCallback:function(){this.canDeactivate=!0,this.$route.router.go({path:"/platform/questionare"})},publishBtnHandler:function(){this.publish=!0,this.saveBtnHandler()},createId:function(){return""},getRandomNumber:function(){return Math.floor(30*Math.random())},deleteQue:function(t){this.questions.splice(t,1)},addOption:function(t){this.questions[t].items.push({title:"选项"+(this.questions[t].items.length+1),weights:10})},copyQuestion:function(t){var e=s()(this.questions[t]),n=JSON.parse(e);this.questions.push(n)},questionPositionChange:function(t,e){this.transposition(this.questions,t,e)},deleteOption:function(t,e){this.questions[t].items.splice(e,1)},changeTextRequired:function(t,e){this.questions[t].required=e},changeQuestionTitle:function(t,e){this.questions[t].title=e},changeOptionValue:function(t,e,n){this.questions[t].items[e].title=n},changeOptionValue1:function(t,e,n){this.questions[t].items[e].weights=n},optionPositionChange:function(){this.transposition(this.questions[qIndex].answers,oOldIndex,oNewIndex)},createE:function(){var t=this;Object(h.d)({title:this.title}).then(function(e){t.evaluationId=e.data.id,t.saveData()})},updateQuestionName:function(t,e,n){console.log("改变的数据为：",t.target.value,t,n,this.title)}},created:function(){},components:{Question:l,Calendar:r.a,Alert:d.a,Modal:p.a},route:{canDeactivate:function(){return!!this.canDeactivate||(this.showModal=!0,!1)}}},f={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"layout"},[n("div",{staticClass:"qn-wrap"},[n("div",{staticClass:"qn"},[n("header",{staticClass:"header"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"title",attrs:{type:"text",placeholder:"填写问卷标题"},domProps:{value:t.title},on:{change:t.updateQuestionName,input:function(e){e.target.composing||(t.title=e.target.value)}}})]),t._v(" "),n("div",{staticClass:"body"},[n("div",{staticClass:"body-wrap"},[0!==t.questions.length?n("ol",{staticClass:"questions"},t._l(t.questions,function(t,e){return n("question",{tag:"li",staticClass:"question",attrs:{"track-by":"$index",qIndex:e,question:t}})})):t._e(),t._v(" "),n("div",{staticClass:"tools"},[n("div",{staticClass:"toolbar"},[n("span",{staticClass:"btn",on:{click:function(e){t.addQuestion("radio")}}},[n("span",{staticClass:"iconfont"},[t._v("")]),t._v("单选题")]),t._v(" "),n("span",{staticClass:"btn",on:{click:function(e){t.addQuestion("checkbox")}}},[n("span",{staticClass:"iconfont"},[t._v("")]),t._v("多选题")]),t._v(" "),n("span",{staticClass:"btn",on:{click:function(e){t.addQuestion("text")}}},[n("span",{staticClass:"iconfont"},[t._v("")]),t._v("文本题")])]),t._v(" "),t._m(0)])])]),t._v(" "),n("footer",{staticClass:"footer"},[n("div",{staticClass:"operation"},[n("span",{staticClass:"btn",class:{disabled:t.isLoading},on:{click:function(e){t.createE()}}},[t._v("保存问卷")])])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"add-btn"},[e("span",{staticClass:"iconfont"},[this._v("")]),this._v("添加问题")])}]};var q=n("VU/8")(v,f,!1,function(t){n("etH8")},null,null);e.default=q.exports},qkKv:function(t,e,n){var i=n("FeBl"),s=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return s.stringify.apply(s,arguments)}}});
//# sourceMappingURL=1.d3fb843afebc059eeadf.js.map