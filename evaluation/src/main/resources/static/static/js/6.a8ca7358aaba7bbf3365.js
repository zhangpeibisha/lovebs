webpackJsonp([6],{Q3je:function(e,t,s){"use strict";t.a=function(e){return Object(a.a)({url:"/teacherCourse/teachTask",method:"get",params:e})},t.b=function(){return Object(a.a)({url:"/teacherCourse/school/year",method:"get"})};var a=s("vLgD")},WcSN:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("woOf"),o=s.n(a),n=s("IcnI"),l=s("Q3je"),i=s("d2gY"),r=s("ts7I"),c=s("Ozlq"),u={year:null,semester:null,page:1,limit:5},d={name:"teachCourse",data:function(){return{listQuery:o()({},u),teachCourseList:[],schoolYear:[2019,2018],semester:[{name:"第一学期",type:"FIRST"},{name:"第二学期",type:"SECOND"}],roles:[],total:0,showImportTask:!1,uploadUrl:i.h,uploadStudentScoreUrl:i.g,showUploadStudentScore:!1,score:0,showScore:!1,courseName:"",isAnswer:!1,showConfigBlack:!1,students:[],blackStudent:[],publishQuestionId:-1,canFilters:0}},created:function(){this.findTeachCourseList(),this.userRole(),this.selectSchoolYearList()},methods:{findTeachCourseList:function(){var e=this;Object(l.a)(this.listQuery).then(function(t){console.log("获取到教学任务",t),e.teachCourseList=t.data.data,e.total=t.data.total})},selectSchoolYearList:function(){var e=this;Object(l.b)().then(function(t){console.log("获取到的学年信息未",t),e.schoolYear=t.data})},handleSelectionChange:function(){},userRole:function(){var e=n.a.state.user;console.log("主页用户信息获取到：",e);var t=e.roles;this.insertRole(t),console.log("主页角色信息获取到：",this.roles)},insertRole:function(e){var t=this;e&&e.forEach(function(e){t.roles.push(e.name)})},handleSizeChange:function(e){this.listQuery.page=1,this.listQuery.limit=e,this.getList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getList()},uploadTaskSuccess:function(){this.selectSchoolYearList(),this.findTeachCourseList(),this.$message({message:"上传成功",type:"success"})},uploadTaskError:function(e){console.log("获取的上传错误信息",e),console.log("获取的上传错误信息====1",e.message),console.log("获取的上传错误信息====2",e.message.msg),console.log("获取的上传错误信息====3",e.msg),this.$message({message:"上传失败:"+e.message,type:"error"})},viewTeachTaskQuestion:function(e){console.log("获取到的信息为：",e),console.log("获取到的信息为,发布评教卷id：",e.publishQuestionnaireId),console.log("获取到的信息为,评教卷id：",e.questionnaireId),this.$router.push({path:"/task/view",query:{evaluationId:e.questionnaireId}})},viewTeachTaskQuestionAnswer:function(e){var t=this;Object(r.b)(e.publishQuestionnaireId).then(function(s){s.data?t.$router.push({path:"/task/view",query:{publishId:e.publishQuestionnaireId}}):t.$message({message:"警告:你还没有回答该教学任务的评教卷",type:"warning"})})},answerSheet:function(e){var t=this;Object(r.b)(e.publishQuestionnaireId).then(function(s){s.data?t.$message({message:"警告:你已经回答该教学任务的评教卷",type:"warning"}):t.$router.push({path:"/task/reply",query:{publishEvaluationId:e.publishQuestionnaireId}})})},viewStatisticsScore:function(e){this.$router.push({path:"/task/statisticsScore",query:{publishEvaluationId:e.publishQuestionnaireId}})},viewScore:function(e){var t=this;try{Object(r.i)(e.teachCourseId).then(function(s){t.score=s.data,t.courseName=e.course.name,t.showScore=!0}).catch(function(e){t.$message({message:"警告:获取分数失败，可能没有回答评教卷",type:"warning"})})}catch(e){console.log("获取错误返回信息=====",e)}},configBlack:function(e){this.findStudentInfo(e),this.publishQuestionId=e.publishQuestionnaireId},submitConfigBlack:function(){var e=this;if(this.showConfigBlack=!1,this.blackStudent){var t=this.blackStudent.length;if(this.canFilters<t)return this.$message({message:"黑名单数量超过限制: 限制="+this.canFilters+" 当前数量="+t,type:"warning"}),void(this.blackStudent=[])}Object(c.b)(this.publishQuestionId,this.blackStudent).then(function(t){e.$message({message:"配置黑名单成功",type:"success"})}).catch(function(t){e.$message({message:"配置黑名单失败",type:"warning"})})},findStudentInfo:function(e){var t=this;console.log("发现学生信息",e),console.log("发现学生信息====",e.publishQuestionnaireId);var s=[];s.push(e.publishQuestionnaireId),Object(c.g)(s).then(function(e){console.log("获取的发布问卷信息为",e);var s=e.data[0].statistics.students;t.blackStudent=e.data[0].statistics.black,t.canFilters=e.data[0].statistics.canFilters,Object(r.j)(s).then(function(e){t.students=e.data,console.log("获取的学生信息======11",t.students),t.showConfigBlack=!0})})}}},h={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container",staticStyle:{height:"500px","overflow-y":"scroll"}},[s("el-card",{staticClass:"filter-container",attrs:{shadow:"never"}},[s("div",[s("i",{staticClass:"el-icon-search"}),e._v(" "),s("span",[e._v("筛选搜索")]),e._v(" "),s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.findTeachCourseList()}}},[e._v("查询结果")]),e._v(" "),s("el-button",{staticStyle:{float:"right","margin-right":"15px"},attrs:{size:"small"},on:{click:function(t){e.handleResetSearch()},"selection-change":e.handleSelectionChange}},[e._v("重置\n      ")])],1),e._v(" "),s("div",{staticStyle:{"margin-top":"15px"}},[s("el-form",{attrs:{inline:!0,model:e.listQuery,size:"small","label-width":"140px"}},[s("el-form-item",{attrs:{label:"学年："}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.listQuery.year,callback:function(t){e.$set(e.listQuery,"year",t)},expression:"listQuery.year"}},e._l(e.schoolYear,function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"学期："}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.listQuery.semester,callback:function(t){e.$set(e.listQuery,"semester",t)},expression:"listQuery.semester"}},e._l(e.semester,function(e){return s("el-option",{key:e.type,attrs:{label:e.name,value:e.type}})}))],1)],1)],1)]),e._v(" "),s("el-card",{staticClass:"operate-container",attrs:{shadow:"never"}},[s("i",{staticClass:"el-icon-tickets"}),e._v(" "),s("span",[e._v("教学任务")]),e._v(" "),e.roles.includes("MANGER")?s("el-button",{staticClass:"btn-add",attrs:{type:"success",size:"mini"},on:{click:function(t){e.showImportTask=!0}}},[e._v("导入教学任务\n    ")]):e._e(),e._v(" "),e.roles.includes("TEACHER")?s("el-button",{staticClass:"btn-add",attrs:{size:"mini",type:"success"},on:{click:function(t){e.showUploadStudentScore=!0}}},[e._v("上传学生课程分数\n    ")]):e._e()],1),e._v(" "),s("el-dialog",{attrs:{title:"上传教学任务",visible:e.showImportTask,width:"30%"},on:{"update:visible":function(t){e.showImportTask=t}}},[s("el-upload",{staticClass:"upload-demo",attrs:{drag:"","on-success":e.uploadTaskSuccess,"on-error":e.uploadTaskError,action:e.uploadUrl,multiple:"",headers:"{'Content-Type':'application/x-www-form-urlencoded'}",name:"teachTask"}},[s("i",{staticClass:"el-icon-upload"}),e._v(" "),s("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),s("em",[e._v("点击上传")])]),e._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("请规范excel格式，不然无法导入")])]),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showImportTask=!1}}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"上传学生学习成绩",visible:e.showUploadStudentScore,width:"30%"},on:{"update:visible":function(t){e.showUploadStudentScore=t}}},[s("el-upload",{staticClass:"upload-demo",attrs:{drag:"","on-success":e.uploadTaskSuccess,"on-error":e.uploadTaskError,action:e.uploadStudentScoreUrl,multiple:"",headers:"{'Content-Type':'application/x-www-form-urlencoded'}",name:"teachCourScore"}},[s("i",{staticClass:"el-icon-upload"}),e._v(" "),s("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),s("em",[e._v("点击上传")])]),e._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("请规范excel格式，不然无法导入")])]),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showUploadStudentScore=!1}}},[e._v("确 定")])],1)],1),e._v(" "),s("div",{staticClass:"table-container"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.teachCourseList,border:""},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"60",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"课程名字",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.course.name))]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"授课老师",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.teacher.name))]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"授课时间（周）",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.startWeek)+"-"+e._s(t.row.endWeek))]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"学年",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.year))]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"学期",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.semester))]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"开始时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.startTime))]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"结束时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.endTime))]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"评教得分",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.teachScore))]}}])}),e._v(" "),s("el-table-column",{staticStyle:{width:"600px"},attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.roles.includes("STUDENT")?e._e():s("el-button",{attrs:{size:"mini"},on:{click:function(s){e.viewTeachTaskQuestion(t.row)}}},[e._v("评教卷\n          ")]),e._v(" "),e.roles.includes("STUDENT")?s("el-button",{attrs:{size:"mini"},on:{click:function(s){e.answerSheet(t.row)}}},[e._v("评教")]):e._e(),e._v(" "),e.roles.includes("STUDENT")?s("el-button",{attrs:{size:"mini"},on:{click:function(s){e.viewTeachTaskQuestionAnswer(t.row)}}},[e._v("\n            查看回答\n          ")]):e._e(),e._v(" "),e.roles.includes("STUDENT")?e._e():s("el-button",{attrs:{size:"mini"},on:{click:function(s){e.viewStatisticsScore(t.row)}}},[e._v("查看统计得分\n          ")]),e._v(" "),e.roles.includes("STUDENT")?s("el-button",{attrs:{size:"mini"},on:{click:function(s){e.viewScore(t.row)}}},[e._v("查看课程得分\n          ")]):e._e(),e._v(" "),e.roles.includes("TEACHER")?s("el-button",{attrs:{size:"mini"},on:{click:function(s){e.configBlack(t.row)}}},[e._v("配置黑名单\n          ")]):e._e()]}}])})],1)],1),e._v(" "),s("div",{staticClass:"pagination-container"},[s("el-pagination",{attrs:{background:"",layout:"total, sizes,prev, pager, next,jumper","page-size":e.listQuery.limit,"page-sizes":[5,10,15],"current-page":e.listQuery.page,total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.listQuery,"page",t)}}})],1),e._v(" "),s("el-dialog",{attrs:{title:e.courseName,visible:e.showScore},on:{"update:visible":function(t){e.showScore=t}}},[s("span",[e._v("得分："+e._s(e.score?e.score:"还未上传分数"))]),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.showScore=!1}}},[e._v("确 定")])],1)]),e._v(" "),s("el-dialog",{attrs:{title:"配置黑名单学生",visible:e.showConfigBlack},on:{"update:visible":function(t){e.showConfigBlack=t}}},[s("el-form",[s("el-form-item",{attrs:{label:"学生"}},[s("el-select",{attrs:{multiple:"",filterable:"","default-first-option":"",placeholder:"请选择学生"},model:{value:e.blackStudent,callback:function(t){e.blackStudent=t},expression:"blackStudent"}},e._l(e.students,function(e){return s("el-option",{key:e.accountId,attrs:{label:e.name,value:e.accountId}})}))],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.showConfigBlack=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.submitConfigBlack}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var p=s("VU/8")(d,h,!1,function(e){s("ycru")},null,null);t.default=p.exports},ycru:function(e,t){}});
//# sourceMappingURL=6.a8ca7358aaba7bbf3365.js.map