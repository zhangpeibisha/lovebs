webpackJsonp([1],{"9Zhn":function(t,n){},mvHQ:function(t,n,e){t.exports={default:e("qkKv"),__esModule:!0}},pxpt:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("mvHQ"),s=e.n(i),o=e("woOf"),a=e.n(o),c={props:{question:{type:Object,required:!0},qIndex:{type:Number,required:!0}},methods:{changeQuestionTitle:function(t,n){this.$parent.changeQuestionTitle(t,n.target.textContent)},questionPositionFront:function(t){this.$parent.questionPositionChange(t,t-1)},questionPositionBack:function(t){this.$parent.questionPositionChange(t,t+1)},deleteQuestion:function(t){this.$parent.deleteQue(t)},changeOptionValue:function(t,n,e){this.$parent.changeOptionValue(t,n,e.target.textContent)},changeOptionValue1:function(t,n,e){this.$parent.changeOptionValue1(t,n,e.target.textContent)},addOption:function(t){this.$parent.addOption(t)},deleteOption:function(t,n){this.$parent.deleteOption(t,n)},copyQuestion:function(t){this.$parent.copyQuestion(t)},changeTextRequired:function(t,n){this.$parent.changeTextRequired("change-text-required",t,n.target.checked)},optionPositionFront:function(t,n){this.$parent.optionPositionChange(t,n,n-1)},optionPositionBack:function(t,n){this.$parent.optionPositionChange(t,n,n+1)}}},u={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("li",[e("div",{staticClass:"content"},[e("p",{staticClass:"input title",attrs:{contenteditable:""},on:{keyup:function(n){t.changeQuestionTitle(t.qIndex,n)}}},[t._v(t._s(t.question.title))]),t._v(" "),"text"!==t.question.questionnaireType?e("ol",{staticClass:"answers"},t._l(t.question.items,function(n,i){return e("li",{staticClass:"answer"},[e("input",{staticClass:"select",attrs:{type:t.question.questionnaireType,name:t.question.title},domProps:{value:"问题"+(t.qIndex+1)}}),t._v(" "),e("div",{staticClass:"option"},[e("div",{staticClass:"input-fix"},[e("p",{staticClass:"input",attrs:{contenteditable:""},on:{keyup:function(n){t.changeOptionValue(t.qIndex,i,n)},change:function(n){t.changeOptionValue(t.qIndex,i,n)}}},[t._v(t._s(n.title))]),t._v(" "),e("p",[t._v("分值:")]),t._v(" "),e("p",{staticClass:"input",attrs:{contenteditable:""},on:{keyup:function(n){t.changeOptionValue1(t.qIndex,i,n)},change:function(n){t.changeOptionValue1(t.qIndex,i,n)}}},[t._v(t._s(n.weights))])]),t._v(" "),e("ul",{staticClass:"option-panel"},[e("li",{staticClass:"iconfont",on:{click:function(n){t.optionPositionFront(t.qIndex,t.$index)}}},[t._v("↑")]),t._v(" "),e("li",{staticClass:"iconfont",on:{click:function(n){t.optionPositionBack(t.qIndex,t.$index)}}},[t._v("↓")]),t._v(" "),e("li",{directives:[{name:"show",rawName:"v-show",value:t.question.items.length>1,expression:"question.items.length > 1"}],staticClass:"iconfont",on:{click:function(n){t.deleteOption(t.qIndex,t.$index)}}},[t._v("")])])])])})):t._e(),t._v(" "),"text"!==t.question.questionnaireType?e("div",{staticClass:"add-option",on:{click:function(n){t.addOption(t.qIndex)}}},[e("span",{staticClass:"iconfont"},[t._v("")]),t._v("添加选项")]):e("div",{staticClass:"option"},[e("textarea",{staticClass:"textarea"}),t._v(" "),e("label",{attrs:{for:"isRequired"}},[e("input",{staticClass:"required",attrs:{id:"isRequired",type:"checkbox"},domProps:{checked:t.question.mustWriter},on:{change:function(n){t.changeTextRequired(t.qIndex,n)}}}),t._v("是否必填")])])]),t._v(" "),e("div",{staticClass:"side"},[e("div",{staticClass:"order"},[t._v("Q"+t._s(t.qIndex+1))]),t._v(" "),e("ul",{staticClass:"opertions"},[e("li",{staticClass:"iconfont",on:{click:function(n){t.questionPositionFront(t.qIndex)}}},[t._v("")]),t._v(" "),e("li",{staticClass:"iconfont",on:{click:function(n){t.questionPositionBack(t.qIndex)}}},[t._v("")]),t._v(" "),e("li",{staticClass:"iconfont",on:{click:function(n){t.copyQuestion(t.qIndex)}}},[t._v("")]),t._v(" "),e("li",{staticClass:"iconfont",on:{click:function(n){t.deleteQuestion(t.qIndex)}}},[t._v("")])])])])},staticRenderFns:[]};var l=e("VU/8")(c,u,!1,function(t){e("z2oT")},"data-v-185f8f5b",null).exports,r=e("NoTa"),d=e("UDO9"),p=e("l2la"),h=e("Ozlq"),v={data:function(){var t=void 0;window.sessionStorage.getItem("edit-mode")?t=window.sessionStorage.getItem("edit-mode"):(t="create",window.sessionStorage.setItem("edit-mode","create"));var n={title:"问卷题目",questions:[],showAlert:!1,publish:!1,showModal:!1,routerCanDeactivate:!1,expires:"",qnId:-1,isLoading:!1,evaluationId:-1};return"create"===t&&a()(n,{qnId:this.createId()}),n},computed:{questionaire:function(){return{title:this.title,questions:this.questions,expires:this.expires,publish:this.publish,qnId:this.qnId}}},methods:{saveData:function(){var t=this;Object(h.a)({evaluationId:this.evaluationId},this.questions).then(function(n){t.$message({message:"恭喜你，成功创建了一个问卷",type:"success"}),t.$router.push({path:"/questionnaire/listView"})})},addQuestion:function(t){var n={title:"问题题目",questionnaireType:t};"text"!==t?n.items=[{title:"选项1",weights:10},{title:"选项2",weights:10}]:(n.mustWriter=!1,n.text=""),this.questions.push(n)},transposition:function(t,n,e){var i=t.splice(n,1)[0];t.splice(e,0,i)},modalCallback:function(){this.canDeactivate=!0,this.$route.router.go({path:"/platform/questionare"})},publishBtnHandler:function(){this.publish=!0,this.saveBtnHandler()},createId:function(){return""},getRandomNumber:function(){return Math.floor(30*Math.random())},deleteQue:function(t){this.questions.splice(t,1)},addOption:function(t){this.questions[t].items.push({title:"选项"+(this.questions[t].items.length+1),weights:10})},copyQuestion:function(t){var n=s()(this.questions[t]),e=JSON.parse(n);this.questions.push(e)},questionPositionChange:function(t,n){this.transposition(this.questions,t,n)},deleteOption:function(t,n){this.questions[t].items.splice(n,1)},changeTextRequired:function(t,n){this.questions[t].required=n},changeQuestionTitle:function(t,n){this.questions[t].title=n},changeOptionValue:function(t,n,e){this.questions[t].items[n].title=e},changeOptionValue1:function(t,n,e){this.questions[t].items[n].weights=e},optionPositionChange:function(){this.transposition(this.questions[qIndex].answers,oOldIndex,oNewIndex)},createE:function(){var t=this;Object(h.d)({title:this.title}).then(function(n){t.evaluationId=n.data.id,t.saveData()})},updateQuestionName:function(t,n,e){console.log("改变的数据为：",t.target.value,t,e,this.title)}},created:function(){},components:{Question:l,Calendar:r.a,Alert:d.a,Modal:p.a},route:{canDeactivate:function(){return!!this.canDeactivate||(this.showModal=!0,!1)}}},f={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"layout"},[e("div",{staticClass:"qn-wrap"},[e("div",{staticClass:"qn"},[e("header",{staticClass:"header"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"title",attrs:{type:"text",placeholder:"填写问卷标题"},domProps:{value:t.title},on:{change:t.updateQuestionName,input:function(n){n.target.composing||(t.title=n.target.value)}}})]),t._v(" "),e("div",{staticClass:"body"},[e("div",{staticClass:"body-wrap"},[0!==t.questions.length?e("ol",{staticClass:"questions"},t._l(t.questions,function(t,n){return e("question",{tag:"li",staticClass:"question",attrs:{"track-by":"$index",qIndex:n,question:t}})})):t._e(),t._v(" "),e("div",{staticClass:"tools"},[e("div",{staticClass:"toolbar"},[e("span",{staticClass:"btn",on:{click:function(n){t.addQuestion("radio")}}},[e("span",{staticClass:"iconfont"},[t._v("")]),t._v("单选题")]),t._v(" "),e("span",{staticClass:"btn",on:{click:function(n){t.addQuestion("checkbox")}}},[e("span",{staticClass:"iconfont"},[t._v("")]),t._v("多选题")]),t._v(" "),e("span",{staticClass:"btn",on:{click:function(n){t.addQuestion("text")}}},[e("span",{staticClass:"iconfont"},[t._v("")]),t._v("文本题")])]),t._v(" "),t._m(0)])])]),t._v(" "),e("footer",{staticClass:"footer"},[e("div",{staticClass:"operation"},[e("span",{staticClass:"btn",class:{disabled:t.isLoading},on:{click:function(n){t.createE()}}},[t._v("保存问卷")]),t._v(" "),e("span",{staticClass:"btn",class:{disabled:t.isLoading},on:{click:t.publishBtnHandler}},[t._v("发布问卷")])])])])])])},staticRenderFns:[function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"add-btn"},[n("span",{staticClass:"iconfont"},[this._v("")]),this._v("添加问题")])}]};var q=e("VU/8")(v,f,!1,function(t){e("9Zhn")},null,null);n.default=q.exports},qkKv:function(t,n,e){var i=e("FeBl"),s=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return s.stringify.apply(s,arguments)}},z2oT:function(t,n){}});
//# sourceMappingURL=1.8f39eb093cfa499d52e4.js.map