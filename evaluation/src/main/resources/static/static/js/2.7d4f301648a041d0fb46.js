webpackJsonp([2],{Ya6Z:function(e,t){},aoLN:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("mvHQ"),s=i.n(n),l=i("ArgV"),a=i("Ozlq"),o={data:function(){return{userInfo:{id:0,jobNumber:"",name:"",imageUrl:"",email:"",phone:""},qnaireTask:{total:0,pending:0,checked:0,complete:0,pendingDetail:[],checkedDetail:[],completeDetail:[]},activeName:"first",clickedQuestionIds:[],clickedQuestionList:[],pendingQuestionIds:[],pendingQuestionList:[],pendingQuestionListShow:[],pendingQuestionCurrPage:1,pendingQuestionPageSize:10,completeQuestionIds:[],selectedStudent:{},completeQuestionLis:[],blacklist:{dialogVisible:!1,showChooseStudentName:{},teacher:[],formLabelWidth:"120px",tempChooseStudent:"",canChoose:0,selectedStudent:{},viewStudent:[]},activeIndex:0}},created:function(){this.findUserInfo()},methods:{findUserInfo:function(){var e=this;Object(l.b)().then(function(t){e.userInfo=t.data.userInfo,e.qnaireTask=e.userInfo.workJson.qnaireTask,e.findUserPendingIds(),e.findUserClickedIds(),e.findUserCompleteIds()})},findUserPendingIds:function(){var e=this,t=[];void 0!==this.qnaireTask.pendingDetail&&(this.qnaireTask.pendingDetail.forEach(function(e){t.push(e.id)}),this.pendingQuestionIds=t,Object(l.a)(this.pendingQuestionIds).then(function(t){t.data.forEach(function(t){var i=t.questionnaire;i.publishId=t.id,e.pendingQuestionList.push(i)}),e.pendingChangePageSize(1)}))},findUserClickedIds:function(){var e=this,t=[];void 0!==this.qnaireTask.checkedDetail&&(this.qnaireTask.checkedDetail.forEach(function(e){t.push(e.id)}),this.clickedQuestionIds=t,Object(l.a)(this.clickedQuestionIds).then(function(t){t.data.forEach(function(t){var i=t.questionnaire;i.publishId=t.id,e.clickedQuestionList.push(i)})}))},findUserCompleteIds:function(){var e=this,t=[];void 0!==this.qnaireTask.completeDetail&&(this.qnaireTask.completeDetail.forEach(function(e){t.push(e.id)}),this.completeQuestionIds=t,Object(l.a)(this.completeQuestionIds).then(function(t){t.data.forEach(function(t){var i=t.questionnaire;i.publishId=t.id,e.completeQuestionLis.push(i)})}))},pendingChangePageSize:function(e){var t=this.pendingQuestionList.length;console.log("获取到未读信息",this.pendingQuestionList);var i=(e-1)*this.pendingQuestionPageSize,n=i+this.pendingQuestionPageSize;console.log(t,i,n),console.log(this.pendingQuestionList.slice(i,n)),this.pendingQuestionListShow=t<n&&t>=i?this.pendingQuestionList.slice(i,t):this.pendingQuestionList.slice(i,n)},handleClick:function(){},handleView:function(e,t){console.log("查看评教卷点击了",e,t),Object(a.j)(t.publishId).then(function(e){}),this.$router.push({path:"/questionnaire/view",query:{evaluationId:t.id}})},findStudentList:function(e,t){var i=this;this.activeIndex=e,this.selectedStudent="",this.blacklist.dialogVisible=!0;var n=t.publishId;Object(a.j)(t.publishId).then(function(e){console.log("查看到评卷信息",e),i.blacklist.canChoose=e.data.statisticsJson.canFilters,i.blacklist.teacher=[],i.blacklist.viewStudent=[];var t=e.data.statisticsJson.black||[];e.data.statisticsJson.students.forEach(function(e){e.index=i.blacklist.teacher.length,console.log("获取到的当前发布id:",n),e.currPublishId=n,i.blacklist.teacher.push(e),i.blacklist.viewStudent.push(e)}),i.blacklist.showChooseStudentName[i.activeIndex]=i.blacklist.viewStudent.filter(function(e){return t.indexOf(e.id)>-1})}),console.log("参与学生",this.blacklist.teacher)},deleteSelect:function(e){this.blacklist.showChooseStudentName[this.activeIndex].splice(e,1),this.blacklist=JSON.parse(s()(this.blacklist))},handleConfig:function(e){this.blacklist.showChooseStudentName[this.activeIndex]=(this.blacklist.showChooseStudentName[this.activeIndex]||[]).concat(this.blacklist.viewStudent[e])},noticeConfig:function(e){var t=this;this.$alert(e,"添加黑名单失败",{confirmButtonText:"确定",callback:function(e){t.$message({type:"warning ",message:"action: "+e})}})},clearBlackListConfig:function(){var e=this;this.blacklist.viewStudent=[],this.blacklist.teacher.forEach(function(t){e.blacklist.viewStudent.push(t)})},submitBlackList:function(){this.blacklist.dialogVisible=!1;var e=this.blacklist.showChooseStudentName[this.activeIndex];if(e.length>this.canChoose)this.noticeConfig("提交失败");else{var t=this.clickedQuestionList[this.activeIndex].publishId,i="";e&&e.forEach(function(e){i+=e.id+","}),Object(a.b)(t,i).then(function(e){console.log("提交黑名单得到响应",e)})}},handleDelete:function(e,t){},updateUserInfo:function(){},updatePassword:function(){}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"personleCenter"},[i("p",{staticClass:"mine"},[e._v("我的个人主页")]),e._v(" "),i("el-container",[i("el-aside",{attrs:{width:"200px"}},[i("img",{attrs:{src:e.userInfo.imageUrl}})]),e._v(" "),i("el-main",[i("p",[e._v("姓名："+e._s(e.userInfo.name))]),e._v(" "),i("p",[e._v("工号："+e._s(e.userInfo.jobNumber))]),e._v(" "),i("p",[e._v("电话："+e._s(e.userInfo.phone))]),e._v(" "),i("p",[e._v("邮箱："+e._s(e.userInfo.email))])])],1),e._v(" "),i("el-dialog",{attrs:{title:"配置不计分学生("+e.blacklist.canChoose+")",visible:e.blacklist.dialogVisible},on:{"update:visible":function(t){e.$set(e.blacklist,"dialogVisible",t)}}},[i("el-form",{attrs:{model:e.blacklist}},[i("el-form-item",{attrs:{label:"不计分学生","label-width":e.blacklist.formLabelWidth}},e._l(e.blacklist.showChooseStudentName[e.activeIndex],function(t,n){return i("el-tag",{key:t.index,attrs:{closable:""},on:{close:function(t){e.deleteSelect(n)}}},[e._v("\n            "+e._s(t.name)+"\n          ")])})),e._v(" "),i("el-form-item",{attrs:{label:"学生列表","label-width":e.blacklist.formLabelWidth}},[[i("el-select",{attrs:{placeholder:"请选择学生",clearable:"",filterable:""},on:{change:function(t){e.handleConfig(t)}},model:{value:e.selectedStudent,callback:function(t){e.selectedStudent=t},expression:"selectedStudent"}},e._l(e.blacklist.viewStudent,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,disabled:e.blacklist.showChooseStudentName[e.activeIndex]&&e.blacklist.showChooseStudentName[e.activeIndex].filter(function(e){return e.id==t.id}).length>0||e.blacklist.showChooseStudentName[e.activeIndex]&&e.blacklist.showChooseStudentName[e.activeIndex].length>=e.blacklist.canChoose,value:t.index}})}))]],2)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.clearBlackListConfig}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.submitBlackList}},[e._v("确 定")])],1)],1),e._v(" "),i("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"未读评教卷("+e.pendingQuestionIds.length+")",name:"first"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.pendingQuestionListShow}},[i("el-table-column",{attrs:{label:"标题",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.title))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"描述",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.descritption))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"作者",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.author.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"创建时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.createtime))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"更新时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.updatetime))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){e.handleView(t.$index,t.row)}}},[e._v("详情")])]}}])})],1),e._v(" "),i("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.pendingQuestionIds.length},on:{"current-change":e.pendingChangePageSize}})],1),e._v(" "),i("el-tab-pane",{attrs:{label:"已经查看评教卷("+e.clickedQuestionIds.length+")",name:"second"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.clickedQuestionList}},[i("el-table-column",{attrs:{label:"标题",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.title))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"描述",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.descritption))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"作者",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.author.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"创建时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.createtime))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"更新时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.updatetime))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){e.findStudentList(t.$index,t.row)}}},[e._v("配置")]),e._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:function(i){e.handleView(t.$index,t.row)}}},[e._v("详情")])]}}])})],1)],1),e._v(" "),i("el-tab-pane",{attrs:{label:"工作台"}},[i("el-row",[i("el-button",{attrs:{type:"success",plain:""}},[e._v("查看课程")]),e._v(" "),i("el-button",{attrs:{type:"success",plain:""}},[e._v("评教卷发布")])],1)],1),e._v(" "),i("el-tab-pane",{attrs:{label:"编辑基本信息"}},[i("el-form",{ref:"form",attrs:{model:e.userInfo,"label-width":"80px",size:"small"}},[i("el-form-item",{attrs:{label:"电话"}},[i("el-input",{staticStyle:{width:"20%"},model:{value:e.userInfo.name,callback:function(t){e.$set(e.userInfo,"name",t)},expression:"userInfo.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"邮箱"}},[i("el-input",{staticStyle:{width:"20%"},model:{value:e.userInfo.email,callback:function(t){e.$set(e.userInfo,"email",t)},expression:"userInfo.email"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.updateUserInfo}},[e._v("提交修改")]),e._v(" "),i("el-button",[e._v("取消")])],1)],1)],1),e._v(" "),i("el-tab-pane",{attrs:{label:"修改密码"}},[i("el-form",{ref:"form",attrs:{model:e.userInfo,"label-width":"80px",size:"small"}},[i("el-form-item",{attrs:{label:"旧密码"}},[i("el-input",{staticStyle:{width:"20%"},model:{value:e.userInfo.name,callback:function(t){e.$set(e.userInfo,"name",t)},expression:"userInfo.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"新密码"}},[i("el-input",{staticStyle:{width:"20%"},model:{value:e.userInfo.email,callback:function(t){e.$set(e.userInfo,"email",t)},expression:"userInfo.email"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"重复新密码"}},[i("el-input",{staticStyle:{width:"20%"},model:{value:e.userInfo.email,callback:function(t){e.$set(e.userInfo,"email",t)},expression:"userInfo.email"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.updatePassword}},[e._v("提交修改")]),e._v(" "),i("el-button",[e._v("取消")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var u=i("VU/8")(o,c,!1,function(e){i("Ya6Z")},"data-v-f03531f0",null);t.default=u.exports},mvHQ:function(e,t,i){e.exports={default:i("qkKv"),__esModule:!0}},qkKv:function(e,t,i){var n=i("FeBl"),s=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return s.stringify.apply(s,arguments)}}});
//# sourceMappingURL=2.7d4f301648a041d0fb46.js.map