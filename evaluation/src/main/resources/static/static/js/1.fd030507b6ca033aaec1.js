webpackJsonp([1],{eszi:function(t,n){},mvHQ:function(t,n,i){t.exports={default:i("qkKv"),__esModule:!0}},pxpt:function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=i("mvHQ"),s=i.n(e),o=i("woOf"),a=i.n(o),c={props:{question:{type:Object,required:!0},qIndex:{type:Number,required:!0}},methods:{changeQuestionTitle:function(t,n){this.$parent.changeQuestionTitle(t,n.target.textContent)},questionPositionFront:function(t){this.$parent.questionPositionChange(t,t-1)},questionPositionBack:function(t){this.$parent.questionPositionChange(t,t+1)},deleteQuestion:function(t){this.$parent.deleteQue(t)},changeOptionValue:function(t,n,i){this.$parent.changeOptionValue(t,n,i.target.textContent)},changeOptionValue1:function(t,n,i){this.$parent.changeOptionValue1(t,n,i.target.textContent)},addOption:function(t){this.$parent.addOption(t)},deleteOption:function(t,n){this.$parent.deleteOption(t,n)},copyQuestion:function(t){this.$parent.copyQuestion(t)},changeTextRequired:function(t,n){this.$parent.changeTextRequired("change-text-required",t,n.target.checked)},optionPositionFront:function(t,n){this.$parent.optionPositionChange(t,n,n-1)},optionPositionBack:function(t,n){this.$parent.optionPositionChange(t,n,n+1)}}},l={render:function(){var t=this,n=t.$createElement,i=t._self._c||n;return i("li",[i("div",{staticClass:"content"},[i("p",{staticClass:"input title",attrs:{contenteditable:""},on:{keyup:function(n){t.changeQuestionTitle(t.qIndex,n)}}},[t._v(t._s(t.question.title))]),t._v(" "),"text"!==t.question.questionnaireType?i("ol",{staticClass:"answers"},t._l(t.question.items,function(n,e){return i("li",{staticClass:"answer"},[i("input",{staticClass:"select",attrs:{type:t.question.questionnaireType,name:t.question.title},domProps:{value:"问题"+(t.qIndex+1)}}),t._v(" "),i("div",{staticClass:"option"},[i("div",{staticClass:"input-fix"},[i("p",{staticClass:"input",attrs:{contenteditable:""},on:{keyup:function(n){t.changeOptionValue(t.qIndex,e,n)},change:function(n){t.changeOptionValue(t.qIndex,e,n)}}},[t._v(t._s(n.title))]),t._v(" "),i("p",[t._v("分值:")]),t._v(" "),i("p",{staticClass:"input",attrs:{contenteditable:""},on:{keyup:function(n){t.changeOptionValue1(t.qIndex,e,n)},change:function(n){t.changeOptionValue1(t.qIndex,e,n)}}},[t._v(t._s(n.weights))])]),t._v(" "),i("ul",{staticClass:"option-panel"},[i("li",{staticClass:"iconfont",on:{click:function(n){t.optionPositionFront(t.qIndex,t.$index)}}},[t._v("↑")]),t._v(" "),i("li",{staticClass:"iconfont",on:{click:function(n){t.optionPositionBack(t.qIndex,t.$index)}}},[t._v("↓")]),t._v(" "),i("li",{directives:[{name:"show",rawName:"v-show",value:t.question.items.length>1,expression:"question.items.length > 1"}],staticClass:"iconfont",on:{click:function(n){t.deleteOption(t.qIndex,t.$index)}}},[t._v("")])])])])})):t._e(),t._v(" "),"text"!==t.question.questionnaireType?i("div",{staticClass:"add-option",on:{click:function(n){t.addOption(t.qIndex)}}},[i("span",{staticClass:"iconfont"},[t._v("")]),t._v("添加选项")]):i("div",{staticClass:"option"},[i("textarea",{staticClass:"textarea"}),t._v(" "),i("label",{attrs:{for:"isRequired"}},[i("input",{staticClass:"required",attrs:{id:"isRequired",type:"checkbox"},domProps:{checked:t.question.mustWriter},on:{change:function(n){t.changeTextRequired(t.qIndex,n)}}}),t._v("是否必填")])])]),t._v(" "),i("div",{staticClass:"side"},[i("div",{staticClass:"order"},[t._v("Q"+t._s(t.qIndex+1))]),t._v(" "),i("ul",{staticClass:"opertions"},[i("li",{staticClass:"iconfont",on:{click:function(n){t.questionPositionFront(t.qIndex)}}},[t._v("")]),t._v(" "),i("li",{staticClass:"iconfont",on:{click:function(n){t.questionPositionBack(t.qIndex)}}},[t._v("")]),t._v(" "),i("li",{staticClass:"iconfont",on:{click:function(n){t.copyQuestion(t.qIndex)}}},[t._v("")]),t._v(" "),i("li",{staticClass:"iconfont",on:{click:function(n){t.deleteQuestion(t.qIndex)}}},[t._v("")])])])])},staticRenderFns:[]};var u=i("VU/8")(c,l,!1,function(t){i("z2oT")},"data-v-185f8f5b",null).exports,r=i("NoTa"),d=i("UDO9"),p=i("l2la"),h=i("Ozlq"),v={data:function(){var t=void 0;window.sessionStorage.getItem("edit-mode")?t=window.sessionStorage.getItem("edit-mode"):(t="create",window.sessionStorage.setItem("edit-mode","create"));var n={title:"问卷题目",questions:[],showAlert:!1,publish:!1,showModal:!1,routerCanDeactivate:!1,expires:"",qnId:-1,isLoading:!1,evaluationId:-1};return"create"===t&&a()(n,{qnId:this.createId()}),n},computed:{questionaire:function(){return{title:this.title,questions:this.questions,expires:this.expires,publish:this.publish,qnId:this.qnId}}},methods:{saveData:function(){Object(h.a)({evaluationId:this.evaluationId},this.questions).then(function(t){})},addQuestion:function(t){var n={title:"问题题目",questionnaireType:t};"text"!==t?n.items=[{title:"选项1",weights:10},{title:"选项2",weights:10}]:(n.mustWriter=!1,n.text=""),this.questions.push(n)},transposition:function(t,n,i){var e=t.splice(n,1)[0];t.splice(i,0,e)},modalCallback:function(){this.canDeactivate=!0,this.$route.router.go({path:"/platform/questionare"})},publishBtnHandler:function(){this.publish=!0,this.saveBtnHandler()},createId:function(){return""},getRandomNumber:function(){return Math.floor(30*Math.random())},deleteQue:function(t){this.questions.splice(t,1)},addOption:function(t){this.questions[t].items.push({title:"选项"+(this.questions[t].items.length+1),weights:10})},copyQuestion:function(t){var n=s()(this.questions[t]),i=JSON.parse(n);this.questions.push(i)},questionPositionChange:function(t,n){this.transposition(this.questions,t,n)},deleteOption:function(t,n){this.questions[t].items.splice(n,1)},changeTextRequired:function(t,n){this.questions[t].required=n},changeQuestionTitle:function(t,n){this.questions[t].title=n},changeOptionValue:function(t,n,i){this.questions[t].items[n].title=i},changeOptionValue1:function(t,n,i){this.questions[t].items[n].weights=i},optionPositionChange:function(){this.transposition(this.questions[qIndex].answers,oOldIndex,oNewIndex)},createE:function(){var t=this;Object(h.d)({title:this.title}).then(function(n){t.evaluationId=n.data.id})}},created:function(){},components:{Question:u,Calendar:r.a,Alert:d.a,Modal:p.a},route:{canDeactivate:function(){return!!this.canDeactivate||(this.showModal=!0,!1)}}},f={render:function(){var t=this,n=t.$createElement,i=t._self._c||n;return i("div",{staticClass:"layout"},[i("div",{staticClass:"qn-wrap"},[i("div",{staticClass:"qn"},[i("header",{staticClass:"header"},[i("input",{directives:[{name:"modal",rawName:"v-modal",value:t.title,expression:"title"}],staticClass:"title",attrs:{type:"text",placeholder:"填写问卷标题"},on:{change:function(n){t.createE()}}})]),t._v(" "),i("div",{staticClass:"body"},[i("div",{staticClass:"body-wrap"},[0!==t.questions.length?i("ol",{staticClass:"questions"},t._l(t.questions,function(t,n){return i("question",{tag:"li",staticClass:"question",attrs:{"track-by":"$index",qIndex:n,question:t}})})):t._e(),t._v(" "),i("div",{staticClass:"tools"},[i("div",{staticClass:"toolbar"},[i("span",{staticClass:"btn",on:{click:function(n){t.addQuestion("radio")}}},[i("span",{staticClass:"iconfont"},[t._v("")]),t._v("单选题")]),t._v(" "),i("span",{staticClass:"btn",on:{click:function(n){t.addQuestion("checkbox")}}},[i("span",{staticClass:"iconfont"},[t._v("")]),t._v("多选题")]),t._v(" "),i("span",{staticClass:"btn",on:{click:function(n){t.addQuestion("text")}}},[i("span",{staticClass:"iconfont"},[t._v("")]),t._v("文本题")])]),t._v(" "),t._m(0)])])]),t._v(" "),i("footer",{staticClass:"footer"},[i("div",{staticClass:"pick-date"},[i("span",{staticClass:"msg"},[t._v("问卷截止日期")]),t._v(" "),i("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:t.expires,callback:function(n){t.expires=n},expression:"expires"}})],1),t._v(" "),i("div",{staticClass:"operation"},[i("span",{staticClass:"btn",class:{disabled:t.isLoading},on:{click:function(n){t.saveData()}}},[t._v("保存问卷")]),t._v(" "),i("span",{staticClass:"btn",class:{disabled:t.isLoading},on:{click:t.publishBtnHandler}},[t._v("发布问卷")])])])])]),t._v(" "),i("alert",{attrs:{show:t.showAlert,placement:"top",duration:"3000",type:"warning",width:"400px",dismissable:""},on:{"update:show":function(n){t.showAlert=n}}},[i("strong",[t._v("您正在离开当前页面 ...")]),t._v(" "),i("p",[t._v("需要先保存问卷吗？")])]),t._v(" "),i("modal",{attrs:{show:t.showModal,"cancel-text":"取消","ok-text":"确定",callback:t.modalCallback,title:"提示"},on:{"update:show":function(n){t.showModal=n}}},[i("div",{attrs:{slot:"modal-body"},slot:"modal-body"},[i("div",[t._v("你的问卷尚未保存，确定要放弃保存此问卷吗？")])])])],1)},staticRenderFns:[function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"add-btn"},[n("span",{staticClass:"iconfont"},[this._v("")]),this._v("添加问题")])}]};var q=i("VU/8")(v,f,!1,function(t){i("eszi")},null,null);n.default=q.exports},qkKv:function(t,n,i){var e=i("FeBl"),s=e.JSON||(e.JSON={stringify:JSON.stringify});t.exports=function(t){return s.stringify.apply(s,arguments)}},z2oT:function(t,n){}});
//# sourceMappingURL=1.fd030507b6ca033aaec1.js.map